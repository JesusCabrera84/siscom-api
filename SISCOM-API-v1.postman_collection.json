{
  "info": {
    "name": "SISCOM API v1 (REST)",
    "description": "Colecci√≥n actualizada siguiendo mejores pr√°cticas REST\n\n‚úÖ Endpoints con versionamiento /api/v1/\n‚úÖ GET para consultas (no POST)\n‚úÖ Query parameters para filtros\n‚úÖ Path parameters para recursos espec√≠ficos",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Health Check",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/health",
          "host": ["{{base_url}}"],
          "path": ["health"]
        },
        "description": "Verifica que el servidor est√© funcionando.\n\n‚úÖ No requiere autenticaci√≥n."
      }
    },
    {
      "name": "üì° Hist√≥rico - M√∫ltiples Dispositivos",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{token}}",
            "description": "Token JWT requerido"
          }
        ],
        "url": {
          "raw": "{{base_url}}/api/v1/communications?device_ids=867564050638581&device_ids=DEVICE123",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "communications"],
          "query": [
            {
              "key": "device_ids",
              "value": "867564050638581",
              "description": "ID del primer dispositivo"
            },
            {
              "key": "device_ids",
              "value": "DEVICE123",
              "description": "ID del segundo dispositivo"
            }
          ]
        },
        "description": "Obtiene el hist√≥rico de comunicaciones de m√∫ltiples dispositivos GPS.\n\n**M√©todo REST:** GET con query parameters\n\n**Query Parameters:**\n- `device_ids`: Lista de IDs (repetir par√°metro para cada ID)\n\n**Ejemplo:**\n```\nGET /api/v1/communications?device_ids=867564050638581&device_ids=DEVICE123\n```"
      }
    },
    {
      "name": "üì° Hist√≥rico - Un Solo Dispositivo",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{token}}",
            "description": "Token JWT requerido"
          }
        ],
        "url": {
          "raw": "{{base_url}}/api/v1/devices/867564050638581/communications",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "devices", "867564050638581", "communications"]
        },
        "description": "Obtiene el hist√≥rico de comunicaciones de UN solo dispositivo GPS.\n\n**M√©todo REST:** GET con path parameter\n\n**Path Parameters:**\n- `device_id`: ID del dispositivo (en la URL)\n\n**Ejemplo:**\n```\nGET /api/v1/devices/867564050638581/communications\n```"
      }
    },
    {
      "name": "üî¥ Stream SSE - M√∫ltiples Dispositivos",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Accept",
            "value": "text/event-stream",
            "description": "Header requerido para SSE"
          }
        ],
        "url": {
          "raw": "{{base_url}}/api/v1/communications/stream?device_ids=867564050638581&device_ids=DEVICE123",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "communications", "stream"],
          "query": [
            {
              "key": "device_ids",
              "value": "867564050638581"
            },
            {
              "key": "device_ids",
              "value": "DEVICE123"
            }
          ]
        },
        "description": "Suscripci√≥n SSE para recibir actualizaciones en tiempo real de m√∫ltiples dispositivos.\n\n**M√©todo REST:** GET con Server-Sent Events\n\n‚ö†Ô∏è **NOTA:** Postman tiene soporte limitado para SSE.\n\n**Probar con cURL:**\n```bash\ncurl -N 'http://10.8.0.1:8000/api/v1/communications/stream?device_ids=867564050638581&device_ids=DEVICE123'\n```\n\n**O con JavaScript:**\n```javascript\nconst eventSource = new EventSource(\n  'http://10.8.0.1:8000/api/v1/communications/stream?device_ids=867564050638581&device_ids=DEVICE123'\n);\n\neventSource.addEventListener('update', (event) => {\n  console.log(JSON.parse(event.data));\n});\n```"
      }
    },
    {
      "name": "üî¥ Stream SSE - Un Solo Dispositivo",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Accept",
            "value": "text/event-stream",
            "description": "Header requerido para SSE"
          }
        ],
        "url": {
          "raw": "{{base_url}}/api/v1/devices/867564050638581/communications/stream",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "devices", "867564050638581", "communications", "stream"]
        },
        "description": "Suscripci√≥n SSE para recibir actualizaciones en tiempo real de UN solo dispositivo.\n\n**M√©todo REST:** GET con path parameter\n\n‚ö†Ô∏è **NOTA:** Postman tiene soporte limitado para SSE.\n\n**Probar con cURL:**\n```bash\ncurl -N 'http://10.8.0.1:8000/api/v1/devices/867564050638581/communications/stream'\n```\n\n**O con JavaScript:**\n```javascript\nconst deviceId = '867564050638581';\nconst eventSource = new EventSource(\n  `http://10.8.0.1:8000/api/v1/devices/${deviceId}/communications/stream`\n);\n\neventSource.addEventListener('update', (event) => {\n  console.log(JSON.parse(event.data));\n});\n```"
      }
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "console.log('üöÄ Request:', pm.info.requestName);"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "console.log('‚úÖ Status:', pm.response.code, pm.response.status);",
          "",
          "if (pm.response.code === 401) {",
          "    console.log('‚ö†Ô∏è Error 401: Token inv√°lido o expirado.');",
          "}",
          "",
          "if (pm.response.code === 422) {",
          "    console.log('‚ö†Ô∏è Error 422: Query parameters incorrectos.');",
          "    console.log('Aseg√∫rate de incluir device_ids en la URL.');",
          "}"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://10.8.0.1:8000",
      "type": "string",
      "description": "URL base de SISCOM API"
    },
    {
      "key": "token",
      "value": "eyJhbGciOiJIUzI1NiJ9.e30.XmNK3GpH3Ys_7wsYBfq4C3M6goz71I7dTgUkuIa5lyQ",
      "type": "string",
      "description": "Token JWT de autenticaci√≥n"
    }
  ]
}

